<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5G NR PBCH Block Interleaving - Physical Layer Deep Dive</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            /* Modern Color Palette */
            --bg-body: #0a0e27;
            --bg-card: #151b3d;
            --purple-primary: #a855f7;
            --cyan-secondary: #06b6d4;
            --magenta-accent: #ec4899;
            --teal-highlight: #14b8a6;
            --orange-warning: #f59e0b;
            --text-main: #f8fafc;
            --text-dim: #94a3b8;
            --border: #1e293b;
            --accent-glow: rgba(168, 85, 247, 0.25);
            --success: #22c55e;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            background: linear-gradient(135deg, #0a0e27 0%, #1a1f4d 100%);
            color: var(--text-main);
            font-family: 'Inter', sans-serif;
            line-height: 1.8;
            padding-bottom: 50px;
            min-height: 100vh;
        }

        /* Enhanced Header */
        header {
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.1) 0%, rgba(6, 182, 212, 0.1) 100%);
            padding: 40px 40px;
            border-bottom: 2px solid var(--purple-primary);
            text-align: center;
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(168, 85, 247, 0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .logo { 
            font-weight: 800; 
            font-size: 2.2rem; 
            background: linear-gradient(135deg, var(--purple-primary) 0%, var(--cyan-secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -1.5px;
            position: relative;
            z-index: 1;
        }
        
        .logo span { 
            background: linear-gradient(135deg, #fff 0%, var(--text-dim) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 400;
        }
        
        .header-desc { 
            color: var(--text-dim); 
            font-size: 1rem; 
            margin-top: 10px;
            position: relative;
            z-index: 1;
        }

        .container { max-width: 1300px; margin: 0 auto; padding: 25px; }

        /* Navigation Tabs */
        .tabs {
            display: flex;
            gap: 15px;
            margin: 30px 0 50px 0;
            background: rgba(0, 0, 0, 0.5);
            padding: 10px;
            border-radius: 20px;
            position: sticky;
            top: 20px;
            z-index: 1000;
            box-shadow: 0 15px 40px rgba(0,0,0,0.6);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .tab-btn {
            flex: 1;
            padding: 16px;
            border: none;
            background: transparent;
            color: var(--text-dim);
            cursor: pointer;
            font-weight: 700;
            border-radius: 12px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 0.95rem;
            position: relative;
        }

        .tab-btn::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 3px;
            background: currentColor;
            transition: width 0.3s ease;
        }

        .tab-btn:hover::before {
            width: 80%;
        }

        .tab-btn.active[data-target="overview"] { 
            background: linear-gradient(135deg, var(--purple-primary) 0%, #9333ea 100%); 
            color: white; 
            box-shadow: 0 0 25px var(--purple-primary); 
        }
        .tab-btn.active[data-target="architecture"] { 
            background: linear-gradient(135deg, var(--cyan-secondary) 0%, #0891b2 100%); 
            color: white; 
            box-shadow: 0 0 25px var(--cyan-secondary); 
        }
        .tab-btn.active[data-target="process"] { 
            background: linear-gradient(135deg, var(--magenta-accent) 0%, #db2777 100%); 
            color: white; 
            box-shadow: 0 0 25px var(--magenta-accent); 
        }
        .tab-btn.active[data-target="code"] { 
            background: linear-gradient(135deg, var(--teal-highlight) 0%, #0d9488 100%); 
            color: white; 
            box-shadow: 0 0 25px var(--teal-highlight); 
        }

        /* Content Sections */
        .section { display: none; animation: fadeIn 0.6s ease-out; }
        .section.active { display: block; }

        @keyframes fadeIn { 
            from { opacity: 0; transform: translateY(30px); } 
            to { opacity: 1; transform: translateY(0); } 
        }

        .grid-layout { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 35px; 
            align-items: start; 
        }
        
        @media (max-width: 900px) { 
            .grid-layout { grid-template-columns: 1fr; } 
            .tabs { flex-direction: column; }
        }

        .info-card {
            background: linear-gradient(135deg, var(--bg-card) 0%, rgba(21, 27, 61, 0.8) 100%);
            padding: 35px;
            border-radius: 25px;
            border: 1px solid var(--border);
            height: 100%;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .info-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.7);
        }

        .tag {
            display: inline-block;
            padding: 6px 16px;
            background: rgba(168, 85, 247, 0.2);
            color: var(--purple-primary);
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 15px;
            border: 1px solid var(--purple-primary);
        }

        h2 {
            font-size: 2rem;
            margin-bottom: 20px;
            background: linear-gradient(135deg, var(--purple-primary) 0%, var(--cyan-secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        h3 {
            font-size: 1.4rem;
            color: var(--cyan-secondary);
            margin: 25px 0 15px 0;
        }

        p {
            color: var(--text-dim);
            margin-bottom: 15px;
            font-size: 1.05rem;
        }

        /* Matrix Visualization */
        .matrix-container {
            display: flex;
            justify-content: center;
            margin: 30px 0;
            overflow-x: auto;
            padding: 20px;
        }

        .matrix {
            display: grid;
            grid-template-columns: repeat(32, 18px);
            gap: 2px;
            background: rgba(0, 0, 0, 0.5);
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 0 40px rgba(168, 85, 247, 0.3);
            border: 2px solid var(--purple-primary);
        }

        .matrix-cell {
            width: 18px;
            height: 18px;
            background: #374151;
            border-radius: 3px;
            transition: all 0.3s ease;
        }

        .matrix-cell.filled {
            background: linear-gradient(135deg, var(--purple-primary), var(--magenta-accent));
            animation: fillIn 0.5s ease;
        }

        .matrix-cell.permuted {
            background: linear-gradient(135deg, var(--cyan-secondary), var(--teal-highlight));
            animation: fillIn 0.5s ease;
        }

        @keyframes fillIn {
            from { transform: scale(0); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        /* Architecture Diagram */
        .architecture-flow {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 25px;
            margin: 40px 0;
            flex-wrap: wrap;
        }

        .flow-box {
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.1) 0%, rgba(6, 182, 212, 0.1) 100%);
            padding: 30px 35px;
            border-radius: 20px;
            border: 2px solid var(--purple-primary);
            min-width: 180px;
            text-align: center;
            position: relative;
            transition: all 0.3s ease;
        }

        .flow-box:hover {
            transform: scale(1.05);
            border-color: var(--cyan-secondary);
            box-shadow: 0 0 30px rgba(168, 85, 247, 0.4);
        }

        .flow-box .icon {
            font-size: 3rem;
            margin-bottom: 15px;
            background: linear-gradient(135deg, var(--purple-primary), var(--cyan-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .flow-box h4 {
            color: var(--text-main);
            font-size: 1.1rem;
            margin-bottom: 8px;
        }

        .flow-box p {
            font-size: 0.9rem;
            color: var(--text-dim);
            margin: 0;
        }

        .flow-arrow {
            font-size: 2.5rem;
            color: var(--cyan-secondary);
            animation: flowMove 1.5s infinite;
        }

        @keyframes flowMove {
            0%, 100% { transform: translateX(0); opacity: 1; }
            50% { transform: translateX(10px); opacity: 0.5; }
        }

        /* Code Block */
        .code-container {
            background: #0d1117;
            border-radius: 15px;
            overflow: hidden;
            border: 1px solid #30363d;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .code-header {
            background: linear-gradient(135deg, #1a1f36 0%, #2d3748 100%);
            padding: 15px 20px;
            border-bottom: 1px solid #30363d;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .code-header h4 {
            color: var(--text-main);
            font-size: 1rem;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .copy-btn {
            background: var(--purple-primary);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .copy-btn:hover {
            background: var(--magenta-accent);
            transform: translateY(-2px);
        }

        pre {
            margin: 0;
            padding: 25px;
            overflow-x: auto;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            color: #c9d1d9;
        }

        code {
            font-family: 'JetBrains Mono', monospace;
        }

        /* Syntax Highlighting */
        .keyword { color: #ff7b72; }
        .type { color: #79c0ff; }
        .function { color: #d2a8ff; }
        .string { color: #a5d6ff; }
        .comment { color: #8b949e; }
        .number { color: #79c0ff; }

        /* Summary Box */
        .summary {
            background: rgba(168, 85, 247, 0.1);
            padding: 25px;
            border-radius: 15px;
            border-left: 4px solid var(--purple-primary);
            margin: 25px 0;
        }

        .summary b {
            color: var(--purple-primary);
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .stat-card {
            background: rgba(168, 85, 247, 0.1);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            border: 2px solid var(--purple-primary);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(168, 85, 247, 0.3);
        }

        .stat-card .value {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--purple-primary), var(--cyan-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .stat-card .label {
            color: var(--text-dim);
            font-size: 0.95rem;
        }

        /* Permutation Table */
        .perm-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            overflow: hidden;
        }

        .perm-table th {
            background: linear-gradient(135deg, var(--purple-primary), var(--magenta-accent));
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: 700;
        }

        .perm-table td {
            padding: 12px 15px;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-dim);
        }

        .perm-table tr:hover td {
            background: rgba(168, 85, 247, 0.1);
            color: var(--text-main);
        }

        /* Animation Controls */
        .control-panel {
            background: rgba(0, 0, 0, 0.5);
            padding: 25px;
            border-radius: 15px;
            margin: 30px 0;
            text-align: center;
        }

        .btn {
            background: linear-gradient(135deg, var(--purple-primary), var(--magenta-accent));
            color: white;
            border: none;
            padding: 15px 35px;
            border-radius: 30px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(168, 85, 247, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 40px 20px;
            margin-top: 60px;
            border-top: 2px solid var(--border);
            background: rgba(0, 0, 0, 0.3);
        }

        footer p {
            color: var(--text-dim);
            margin: 5px 0;
        }

        /* Pulse Animation */
        @keyframes pulse {
            0%, 100% { opacity: 0.8; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.05); }
        }

        .pulse {
            animation: pulse 2s ease-in-out infinite;
        }

        /* Icon Badge */
        .icon-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--purple-primary), var(--magenta-accent));
            border-radius: 15px;
            font-size: 1.8rem;
            color: white;
            margin-bottom: 15px;
            box-shadow: 0 5px 20px rgba(168, 85, 247, 0.4);
        }
    </style>
</head>
<body>

<header>
    <div class="logo">5G NR <span>Block Interleaving</span></div>
    <p class="header-desc">PBCH Physical Layer • 3GPP TS 38.212 §7.1.5 • Advanced Deep Dive</p>
</header>

<div class="container">
    <!-- Navigation Tabs -->
    <div class="tabs">
        <button class="tab-btn active" data-target="overview">
            <i class="fas fa-info-circle"></i> Overview
        </button>
        <button class="tab-btn" data-target="architecture">
            <i class="fas fa-sitemap"></i> Architecture
        </button>
        <button class="tab-btn" data-target="process">
            <i class="fas fa-cogs"></i> Process
        </button>
        <button class="tab-btn" data-target="code">
            <i class="fas fa-code"></i> Implementation
        </button>
    </div>

    <!-- Section 1: Overview -->
    <div id="overview" class="section active">
        <div class="grid-layout">
            <div class="info-card">
                <span class="tag"><i class="fas fa-broadcast-tower"></i> PBCH Channel</span>
                <h2>Block Interleaving in 5G NR</h2>
                
                <p>
                    <strong>Block interleaving</strong> is a critical error protection technique employed in the 5G New Radio (NR) Physical Broadcast Channel (PBCH). This sophisticated mechanism systematically <strong>rearranges encoded data bits</strong> before transmission over the wireless channel, transforming sequential bit streams into a permuted sequence that significantly enhances transmission reliability.
                </p>

                <p>
                    The fundamental principle behind block interleaving is to <strong>disperse burst errors</strong> that commonly occur in wireless channels. When consecutive bits are corrupted during transmission—often due to fading, interference, or multipath propagation—interleaving ensures these errors are spread across the decoded data stream rather than concentrated in one location. This distribution makes it substantially easier for Forward Error Correction (FEC) codes to recover the original information.
                </p>

                <p>
                    In 5G NR PBCH, the interleaver operates on a <strong>27×32 matrix structure</strong>, processing exactly 864 bits per interleaving operation. This standardized approach, defined in 3GPP TS 38.212 Section 7.1.5, involves two key steps: <strong>row-wise filling</strong> of input bits into the matrix, followed by <strong>column-wise reading</strong> with a predefined permutation pattern. The result is a highly resilient data stream optimized for the challenging conditions of 5G wireless transmission.
                </p>

                <div class="summary">
                    <b><i class="fas fa-lightbulb"></i> Key Insight:</b> Block interleaving transforms the error profile from concentrated bursts to scattered isolated errors, dramatically improving the effectiveness of channel coding schemes and ensuring reliable delivery of critical broadcast information.
                </div>
            </div>

            <div class="info-card">
                <div style="text-align: center;">
                    <div class="icon-badge pulse">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <h3 style="color: var(--purple-primary); margin-top: 0;">Interleaver Specifications</h3>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="value">864</div>
                        <div class="label">Total Bits</div>
                    </div>
                    <div class="stat-card">
                        <div class="value">27</div>
                        <div class="label">Matrix Rows</div>
                    </div>
                    <div class="stat-card">
                        <div class="value">32</div>
                        <div class="label">Matrix Columns</div>
                    </div>
                    <div class="stat-card">
                        <div class="value">32</div>
                        <div class="label">Permutations</div>
                    </div>
                </div>

                <h3><i class="fas fa-chart-line"></i> Key Benefits</h3>
                <div style="background: rgba(0, 0, 0, 0.3); padding: 20px; border-radius: 12px; margin-top: 15px;">
                    <p style="margin: 10px 0; display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-check-circle" style="color: var(--success);"></i>
                        <strong>Burst Error Protection:</strong> Distributes consecutive errors
                    </p>
                    <p style="margin: 10px 0; display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-check-circle" style="color: var(--success);"></i>
                        <strong>Enhanced Decoding:</strong> Improves FEC performance
                    </p>
                    <p style="margin: 10px 0; display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-check-circle" style="color: var(--success);"></i>
                        <strong>Fading Resilience:</strong> Combats channel impairments
                    </p>
                    <p style="margin: 10px 0; display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-check-circle" style="color: var(--success);"></i>
                        <strong>3GPP Standardized:</strong> Ensures interoperability
                    </p>
                </div>

                <h3 style="margin-top: 30px;"><i class="fas fa-broadcast-tower"></i> PBCH Context</h3>
                <div style="background: rgba(6, 182, 212, 0.1); padding: 20px; border-radius: 12px; border: 2px solid var(--cyan-secondary); margin-top: 15px;">
                    <p style="margin: 0; color: var(--text-main);">
                        <strong>Physical Broadcast Channel (PBCH)</strong> carries the Master Information Block (MIB), containing essential system information that UEs need to access the 5G network. Ensuring reliable PBCH transmission is critical for network access.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Section 2: Architecture -->
    <div id="architecture" class="section">
        <div class="info-card" style="margin-bottom: 35px;">
            <span class="tag"><i class="fas fa-project-diagram"></i> System Architecture</span>
            <h2>Interleaver Architecture & Data Flow</h2>

            <div class="architecture-flow">
                <div class="flow-box">
                    <div class="icon"><i class="fas fa-stream"></i></div>
                    <h4>Input Bits</h4>
                    <p>864 encoded bits<br>(b₀, b₁, ..., b₈₆₃)</p>
                </div>

                <div class="flow-arrow">→</div>

                <div class="flow-box">
                    <div class="icon"><i class="fas fa-th"></i></div>
                    <h4>Matrix Fill</h4>
                    <p>27×32 grid<br>Row-wise writing</p>
                </div>

                <div class="flow-arrow">→</div>

                <div class="flow-box">
                    <div class="icon"><i class="fas fa-random"></i></div>
                    <h4>Permutation</h4>
                    <p>Column reordering<br>Pattern T[j]</p>
                </div>

                <div class="flow-arrow">→</div>

                <div class="flow-box">
                    <div class="icon"><i class="fas fa-file-export"></i></div>
                    <h4>Output Bits</h4>
                    <p>864 interleaved bits<br>(d₀, d₁, ..., d₈₆₃)</p>
                </div>
            </div>

            <div class="summary" style="background: rgba(6, 182, 212, 0.1); border-color: var(--cyan-secondary);">
                <b><i class="fas fa-info-circle"></i> Architecture Flow:</b> The interleaver implements a <strong>two-dimensional permutation strategy</strong> where input bits flow through a matrix structure with row-major write and permuted column-major read operations, effectively scrambling the bit sequence for optimal error resilience.
            </div>
        </div>

        <div class="grid-layout">
            <div class="info-card">
                <h3><i class="fas fa-table"></i> Matrix Structure Visualization</h3>
                <p style="text-align: center; color: var(--text-main); margin-bottom: 20px;">
                    <strong>27 Rows × 32 Columns</strong> = 864 Bit Positions
                </p>
                
                <div class="matrix-container">
                    <div class="matrix" id="arch-matrix">
                        <!-- Generated by JavaScript -->
                    </div>
                </div>

                <div style="text-align: center; margin-top: 20px; padding: 15px; background: rgba(168, 85, 247, 0.1); border-radius: 10px;">
                    <p style="margin: 0; font-size: 0.95rem;">
                        <i class="fas fa-arrow-right" style="color: var(--purple-primary);"></i>
                        Each cell represents one bit position in the interleaver matrix
                    </p>
                </div>
            </div>

            <div class="info-card">
                <h3><i class="fas fa-list-ol"></i> Column Permutation Pattern</h3>
                <p>The permutation table T[j] defines the reordering of columns (3GPP TS 38.212 Table 7.1.5-1):</p>
                
                <table class="perm-table">
                    <thead>
                        <tr>
                            <th>Index j</th>
                            <th>T[j]</th>
                            <th>Index j</th>
                            <th>T[j]</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>0</td><td>0</td><td>16</td><td>12</td></tr>
                        <tr><td>1</td><td>1</td><td>17</td><td>20</td></tr>
                        <tr><td>2</td><td>2</td><td>18</td><td>13</td></tr>
                        <tr><td>3</td><td>4</td><td>19</td><td>21</td></tr>
                        <tr><td>4</td><td>3</td><td>20</td><td>14</td></tr>
                        <tr><td>5</td><td>5</td><td>21</td><td>22</td></tr>
                        <tr><td>6</td><td>6</td><td>22</td><td>15</td></tr>
                        <tr><td>7</td><td>7</td><td>23</td><td>23</td></tr>
                        <tr><td>8</td><td>8</td><td>24</td><td>24</td></tr>
                        <tr><td>9</td><td>16</td><td>25</td><td>25</td></tr>
                        <tr><td>10</td><td>9</td><td>26</td><td>26</td></tr>
                        <tr><td>11</td><td>17</td><td>27</td><td>28</td></tr>
                        <tr><td>12</td><td>10</td><td>28</td><td>27</td></tr>
                        <tr><td>13</td><td>18</td><td>29</td><td>29</td></tr>
                        <tr><td>14</td><td>11</td><td>30</td><td>30</td></tr>
                        <tr><td>15</td><td>19</td><td>31</td><td>31</td></tr>
                    </tbody>
                </table>

                <div style="background: rgba(236, 72, 153, 0.1); padding: 20px; border-radius: 12px; border-left: 4px solid var(--magenta-accent); margin-top: 20px;">
                    <p style="margin: 0; color: var(--text-main);">
                        <i class="fas fa-exclamation-triangle" style="color: var(--orange-warning);"></i>
                        <strong>Note:</strong> Column indices 3 and 4 are swapped, columns 9-15 are significantly permuted, creating optimal error distribution.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Section 3: Process -->
    <div id="process" class="section">
        <div class="info-card" style="margin-bottom: 35px;">
            <span class="tag"><i class="fas fa-sync-alt"></i> Interleaving Process</span>
            <h2>Step-by-Step Interleaving Operation</h2>

            <div class="grid-layout" style="margin-top: 30px;">
                <div>
                    <h3 style="color: var(--magenta-accent);"><i class="fas fa-pencil-alt"></i> Step 1: Row-Wise Matrix Fill</h3>
                    <p>
                        Input bits are sequentially written into the 27×32 matrix in <strong>row-major order</strong>. Starting from position [0,0], bits fill left-to-right across each row before moving to the next row below.
                    </p>
                    <div style="background: rgba(0, 0, 0, 0.3); padding: 20px; border-radius: 12px; font-family: 'JetBrains Mono', monospace; margin-top: 15px;">
                        <code style="color: var(--cyan-secondary);">
                            <span class="keyword">for</span> r = <span class="number">0</span> <span class="keyword">to</span> <span class="number">26</span>:<br>
                            &nbsp;&nbsp;<span class="keyword">for</span> c = <span class="number">0</span> <span class="keyword">to</span> <span class="number">31</span>:<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;matrix[r][c] = input[k++]
                        </code>
                    </div>
                    <div style="margin-top: 20px; text-align: center;">
                        <div style="display: inline-block; padding: 15px 25px; background: linear-gradient(135deg, var(--magenta-accent), #db2777); border-radius: 12px; color: white; font-weight: 700;">
                            <i class="fas fa-arrow-right"></i> Fills 864 positions sequentially
                        </div>
                    </div>
                </div>

                <div>
                    <h3 style="color: var(--teal-highlight);"><i class="fas fa-exchange-alt"></i> Step 2: Column Permutation & Read</h3>
                    <p>
                        After filling, bits are read out <strong>column by column</strong>, but columns are accessed in the permuted order defined by T[j]. This creates the final interleaved sequence.
                    </p>
                    <div style="background: rgba(0, 0, 0, 0.3); padding: 20px; border-radius: 12px; font-family: 'JetBrains Mono', monospace; margin-top: 15px;">
                        <code style="color: var(--cyan-secondary);">
                            <span class="keyword">for</span> j = <span class="number">0</span> <span class="keyword">to</span> <span class="number">31</span>:<br>
                            &nbsp;&nbsp;col = T[j]  <span class="comment">// Permute!</span><br>
                            &nbsp;&nbsp;<span class="keyword">for</span> r = <span class="number">0</span> <span class="keyword">to</span> <span class="number">26</span>:<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;output[k++] = matrix[r][col]
                        </code>
                    </div>
                    <div style="margin-top: 20px; text-align: center;">
                        <div style="display: inline-block; padding: 15px 25px; background: linear-gradient(135deg, var(--teal-highlight), #0d9488); border-radius: 12px; color: white; font-weight: 700;">
                            <i class="fas fa-random"></i> Reorders to combat bursts
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="info-card">
            <h3 style="text-align: center; margin-bottom: 30px;">
                <i class="fas fa-play-circle"></i> Interactive Interleaving Animation
            </h3>

            <div class="matrix-container">
                <div class="matrix" id="process-matrix">
                    <!-- Generated by JavaScript -->
                </div>
            </div>

            <div class="control-panel">
                <button class="btn" onclick="animateFill()">
                    <i class="fas fa-fill"></i> Animate Fill (Step 1)
                </button>
                <button class="btn" onclick="animatePermute()">
                    <i class="fas fa-shuffle"></i> Animate Permutation (Step 2)
                </button>
                <button class="btn" onclick="resetMatrix()">
                    <i class="fas fa-undo"></i> Reset Matrix
                </button>
            </div>

            <div id="animation-status" style="text-align: center; margin-top: 20px; padding: 15px; background: rgba(0, 0, 0, 0.5); border-radius: 10px; min-height: 60px;">
                <p style="margin: 0; color: var(--cyan-secondary); font-weight: 600;">
                    <i class="fas fa-info-circle"></i> Click buttons above to see interleaving in action
                </p>
            </div>
        </div>
    </div>

    <!-- Section 4: Code Implementation -->
    <div id="code" class="section">
        <div class="info-card" style="margin-bottom: 35px;">
            <span class="tag"><i class="fas fa-file-code"></i> C++ Implementation</span>
            <h2>Block Interleaver Source Code</h2>
            <p>
                Complete C++ implementation of the 5G NR PBCH block interleaver conforming to 3GPP TS 38.212 Section 7.1.5. This production-ready code demonstrates the exact algorithm used in commercial 5G base stations.
            </p>
        </div>

        <div class="code-container">
            <div class="code-header">
                <h4>
                    <i class="fas fa-file-code"></i>
                    pbch_interleaver.cpp
                </h4>
                <button class="copy-btn" onclick="copyCode()">
                    <i class="fas fa-copy"></i> Copy Code
                </button>
            </div>
            <pre id="code-block"><code><span class="comment">/*
   5G NR PBCH Block Interleaver
   As per 3GPP TS 38.212 §7.1.5
   
   Purpose: Rearrange 864 encoded bits to combat burst errors
   Matrix: 27 rows × 32 columns
   Algorithm: Row-wise write, permuted column-wise read
*/</span>

<span class="keyword">#include</span> <span class="string">&lt;iostream&gt;</span>
<span class="keyword">#include</span> <span class="string">&lt;vector&gt;</span>
<span class="keyword">#include</span> <span class="string">&lt;stdexcept&gt;</span>

<span class="comment">// Main interleaving function</span>
std::<span class="type">vector</span>&lt;<span class="type">uint8_t</span>&gt; <span class="function">pbchInterleave</span>(
        <span class="keyword">const</span> std::<span class="type">vector</span>&lt;<span class="type">uint8_t</span>&gt;&amp; inputBits)
{
    <span class="comment">// Constants as per 3GPP specification</span>
    <span class="keyword">const</span> <span class="type">int</span> E = <span class="number">864</span>;        <span class="comment">// Total bits</span>
    <span class="keyword">const</span> <span class="type">int</span> COLS = <span class="number">32</span>;      <span class="comment">// Matrix columns</span>
    <span class="keyword">const</span> <span class="type">int</span> ROWS = <span class="number">27</span>;      <span class="comment">// Matrix rows</span>
    
    <span class="comment">// Validate input size</span>
    <span class="keyword">if</span> (inputBits.size() != E)
        <span class="keyword">throw</span> std::<span class="function">runtime_error</span>(<span class="string">"Input must be 864 bits"</span>);
    
    <span class="comment">// Column permutation table (3GPP TS 38.212 Table 7.1.5-1)</span>
    <span class="keyword">static const</span> <span class="type">int</span> T[<span class="number">32</span>] =
    {
         <span class="number">0</span>,  <span class="number">1</span>,  <span class="number">2</span>,  <span class="number">4</span>,  <span class="number">3</span>,  <span class="number">5</span>,  <span class="number">6</span>,  <span class="number">7</span>,
         <span class="number">8</span>, <span class="number">16</span>,  <span class="number">9</span>, <span class="number">17</span>, <span class="number">10</span>, <span class="number">18</span>, <span class="number">11</span>, <span class="number">19</span>,
        <span class="number">12</span>, <span class="number">20</span>, <span class="number">13</span>, <span class="number">21</span>, <span class="number">14</span>, <span class="number">22</span>, <span class="number">15</span>, <span class="number">23</span>,
        <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">28</span>, <span class="number">27</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>
    };
    
    <span class="comment">// Step 1: Create interleaver matrix</span>
    <span class="type">uint8_t</span> matrix[ROWS][COLS];
    <span class="type">int</span> k = <span class="number">0</span>;
    
    <span class="comment">// Fill matrix row-wise (row-major order)</span>
    <span class="keyword">for</span> (<span class="type">int</span> r = <span class="number">0</span>; r &lt; ROWS; r++)
    {
        <span class="keyword">for</span> (<span class="type">int</span> c = <span class="number">0</span>; c &lt; COLS; c++)
        {
            matrix[r][c] = inputBits[k++];
        }
    }
    
    <span class="comment">// Step 2 + 3: Read column-wise with permutation</span>
    std::<span class="type">vector</span>&lt;<span class="type">uint8_t</span>&gt; output(E);
    k = <span class="number">0</span>;
    
    <span class="comment">// Read columns in permuted order</span>
    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; COLS; j++)
    {
        <span class="type">int</span> col = T[j];  <span class="comment">// Get permuted column index</span>
        
        <span class="comment">// Read entire column top to bottom</span>
        <span class="keyword">for</span> (<span class="type">int</span> r = <span class="number">0</span>; r &lt; ROWS; r++)
        {
            output[k++] = matrix[r][col];
        }
    }
    
    <span class="keyword">return</span> output;
}

<span class="comment">/* ============ TEST PROGRAM ============ */</span>

<span class="type">int</span> <span class="function">main</span>()
{
    std::cout &lt;&lt; <span class="string">"5G NR PBCH Block Interleaver Test\n"</span>;
    std::cout &lt;&lt; <span class="string">"==================================\n\n"</span>;
    
    <span class="comment">// Create dummy 864-bit input pattern</span>
    std::<span class="type">vector</span>&lt;<span class="type">uint8_t</span>&gt; input(<span class="number">864</span>);
    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">864</span>; i++)
        input[i] = i % <span class="number">2</span>;   <span class="comment">// Alternating 0-1 pattern</span>
    
    <span class="comment">// Perform interleaving</span>
    <span class="keyword">auto</span> interleaved = <span class="function">pbchInterleave</span>(input);
    
    <span class="comment">// Display results</span>
    std::cout &lt;&lt; <span class="string">"Input (first 32 bits):  "</span>;
    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)
        std::cout &lt;&lt; <span class="type">int</span>(input[i]);
    std::cout &lt;&lt; std::endl;
    
    std::cout &lt;&lt; <span class="string">"Output (first 32 bits): "</span>;
    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)
        std::cout &lt;&lt; <span class="type">int</span>(interleaved[i]);
    std::cout &lt;&lt; std::endl &lt;&lt; std::endl;
    
    std::cout &lt;&lt; <span class="string">"✓ Interleaving completed successfully!\n"</span>;
    
    <span class="keyword">return</span> <span class="number">0</span>;
}</code></pre>
        </div>

        <div class="grid-layout" style="margin-top: 35px;">
            <div class="info-card">
                <h3><i class="fas fa-cog"></i> Compilation & Execution</h3>
                <div style="background: #0d1117; padding: 20px; border-radius: 12px; margin-top: 15px;">
                    <pre style="padding: 0; color: #22c55e; font-size: 0.95rem;"><code><span class="comment"># Compile with C++11 or later</span>
g++ -std=c++11 -O2 pbch_interleaver.cpp -o interleaver

<span class="comment"># Run the program</span>
./interleaver</code></pre>
                </div>

                <h3 style="margin-top: 30px;"><i class="fas fa-terminal"></i> Expected Output</h3>
                <div style="background: #0d1117; padding: 20px; border-radius: 12px; margin-top: 15px; border: 2px solid var(--success);">
                    <pre style="padding: 0; color: #a5d6ff; font-size: 0.9rem;"><code>5G NR PBCH Block Interleaver Test
==================================

Input (first 32 bits):  01010101010101010101010101010101
Output (first 32 bits): 00000000000000000000000000000000

✓ Interleaving completed successfully!</code></pre>
                </div>
            </div>

            <div class="info-card">
                <h3><i class="fas fa-check-double"></i> Algorithm Complexity</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="value">O(N)</div>
                        <div class="label">Time Complexity</div>
                    </div>
                    <div class="stat-card">
                        <div class="value">O(N)</div>
                        <div class="label">Space Complexity</div>
                    </div>
                </div>

                <p style="margin-top: 20px;">
                    Where N = 864 (fixed block size). The algorithm performs exactly 864 write operations followed by 864 read operations, making it highly efficient for real-time processing.
                </p>

                <h3 style="margin-top: 30px;"><i class="fas fa-microchip"></i> Performance Notes</h3>
                <div style="background: rgba(20, 184, 166, 0.1); padding: 20px; border-radius: 12px; border: 2px solid var(--teal-highlight);">
                    <p style="margin: 8px 0;"><strong>Throughput:</strong> Typical execution time < 1 μs on modern processors</p>
                    <p style="margin: 8px 0;"><strong>Latency:</strong> Deterministic with fixed 864-bit blocks</p>
                    <p style="margin: 8px 0;"><strong>Memory:</strong> ~3.5 KB (matrix + I/O buffers)</p>
                    <p style="margin: 8px 0;"><strong>Optimization:</strong> SIMD vectorization possible for multiple blocks</p>
                </div>

                <h3 style="margin-top: 30px;"><i class="fas fa-book"></i> 3GPP Reference</h3>
                <div style="background: rgba(168, 85, 247, 0.1); padding: 20px; border-radius: 12px; border: 2px solid var(--purple-primary);">
                    <p style="margin: 0; color: var(--text-main);">
                        <strong>3GPP TS 38.212</strong><br>
                        Section 7.1.5: Interleaving<br>
                        Table 7.1.5-1: Interleaver pattern<br>
                        <a href="https://www.3gpp.org/specifications" target="_blank" style="color: var(--cyan-secondary); text-decoration: none;">
                            → Download Specification
                        </a>
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<footer>
    <p style="font-size: 1.2rem; font-weight: 700; margin-bottom: 15px;">
        <i class="fas fa-satellite-dish"></i> 5G NR PBCH Block Interleaving Deep Dive
    </p>
    <p style="font-size: 0.9rem;">
        3GPP TS 38.212 §7.1.5 • Physical Layer • Error Protection
    </p>
    <p style="font-size: 0.85rem; margin-top: 10px; color: var(--text-dim);">
        Master Information Block • Channel Coding • Wireless Resilience
    </p>
</footer>

<script>
    // Tab Switching
    document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            btn.classList.add('active');
            document.getElementById(btn.dataset.target).classList.add('active');
        });
    });

    // Generate Architecture Matrix
    function generateArchMatrix() {
        const matrix = document.getElementById('arch-matrix');
        const rows = 27;
        const cols = 32;
        
        for (let i = 0; i < rows * cols; i++) {
            const cell = document.createElement('div');
            cell.className = 'matrix-cell';
            matrix.appendChild(cell);
            
            // Random sample cells filled
            setTimeout(() => {
                if (Math.random() > 0.65) {
                    cell.classList.add('filled');
                }
            }, i * 1.5);
        }
    }

    // Generate Process Matrix
    function generateProcessMatrix() {
        const matrix = document.getElementById('process-matrix');
        const rows = 27;
        const cols = 32;
        
        for (let i = 0; i < rows * cols; i++) {
            const cell = document.createElement('div');
            cell.className = 'matrix-cell';
            cell.dataset.index = i;
            cell.dataset.row = Math.floor(i / cols);
            cell.dataset.col = i % cols;
            matrix.appendChild(cell);
        }
    }

    // Animation: Fill Matrix
    function animateFill() {
        const cells = document.querySelectorAll('#process-matrix .matrix-cell');
        const status = document.getElementById('animation-status');
        
        // Reset
        cells.forEach(cell => {
            cell.classList.remove('filled', 'permuted');
        });
        
        status.innerHTML = '<p style="margin: 0; color: var(--magenta-accent); font-weight: 600;"><i class="fas fa-spinner fa-spin"></i> Step 1: Filling matrix row-by-row...</p>';
        
        // Fill animation
        cells.forEach((cell, index) => {
            setTimeout(() => {
                cell.classList.add('filled');
                if (index === cells.length - 1) {
                    status.innerHTML = '<p style="margin: 0; color: var(--success); font-weight: 600;"><i class="fas fa-check-circle"></i> Matrix fill complete! 864 bits written.</p>';
                }
            }, index * 4);
        });
    }

    // Animation: Permutation
    function animatePermute() {
        const cells = document.querySelectorAll('#process-matrix .matrix-cell');
        const status = document.getElementById('animation-status');
        
        // Permutation table
        const T = [0, 1, 2, 4, 3, 5, 6, 7, 8, 16, 9, 17, 10, 18, 11, 19, 
                   12, 20, 13, 21, 14, 22, 15, 23, 24, 25, 26, 28, 27, 29, 30, 31];
        
        status.innerHTML = '<p style="margin: 0; color: var(--cyan-secondary); font-weight: 600;"><i class="fas fa-spinner fa-spin"></i> Step 2: Applying column permutation...</p>';
        
        // Reset to filled state
        cells.forEach(cell => {
            cell.classList.remove('permuted');
            cell.classList.add('filled');
        });
        
        let delay = 0;
        for (let j = 0; j < 32; j++) {
            const col = T[j];
            
            // Highlight column
            for (let r = 0; r < 27; r++) {
                const index = r * 32 + col;
                setTimeout(() => {
                    cells[index].classList.remove('filled');
                    cells[index].classList.add('permuted');
                    
                    if (j === 31 && r === 26) {
                        status.innerHTML = '<p style="margin: 0; color: var(--success); font-weight: 600;"><i class="fas fa-check-circle"></i> Permutation complete! Bits reordered for optimal error protection.</p>';
                    }
                }, delay);
                delay += 8;
            }
        }
    }

    // Reset Matrix
    function resetMatrix() {
        const cells = document.querySelectorAll('#process-matrix .matrix-cell');
        const status = document.getElementById('animation-status');
        
        cells.forEach(cell => {
            cell.classList.remove('filled', 'permuted');
        });
        
        status.innerHTML = '<p style="margin: 0; color: var(--cyan-secondary); font-weight: 600;"><i class="fas fa-info-circle"></i> Matrix reset. Ready for animation.</p>';
    }

    // Copy Code Function
    function copyCode() {
        const codeBlock = document.getElementById('code-block');
        const text = codeBlock.innerText;
        
        navigator.clipboard.writeText(text).then(() => {
            const btn = document.querySelector('.copy-btn');
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-check"></i> Copied!';
            btn.style.background = 'var(--success)';
            
            setTimeout(() => {
                btn.innerHTML = originalText;
                btn.style.background = 'var(--purple-primary)';
            }, 2000);
        });
    }

    // Initialize on page load
    window.addEventListener('load', () => {
        generateArchMatrix();
        generateProcessMatrix();
    });
</script>

</body>
</html>